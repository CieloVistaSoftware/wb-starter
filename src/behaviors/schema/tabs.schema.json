{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Tabs",
  "description": "Tab navigation component for switching between content panels",
  "behavior": "tabs",
  
  "properties": {
    "activeTab": {
      "type": "number",
      "description": "Index of initially active tab (0-based)",
      "minimum": 0,
      "default": 0
    }
  },

  "compliance": {
    "baseClass": "wb-tabs",
    "requiredChildren": {},
    "optionalChildren": {
      ".wb-tabs__nav": {
        "description": "Tab navigation container",
        "role": "tablist"
      },
      ".wb-tabs__tab": {
        "description": "Individual tab buttons",
        "role": "tab"
      },
      ".wb-tabs__panel": {
        "description": "Tab content panels",
        "role": "tabpanel"
      }
    }
  },

  "interactions": {
    "elements": {
      ".wb-tabs__tab": {
        "type": "tab",
        "clickable": true,
        "click": {
          "action": "activate tab",
          "event": "wb:tabs:change"
        }
      }
    },
    "keyboard": {
      "ArrowRight": {
        "target": ".wb-tabs__tab",
        "action": "focus next tab"
      },
      "ArrowLeft": {
        "target": ".wb-tabs__tab",
        "action": "focus previous tab"
      },
      "Home": {
        "target": ".wb-tabs__tab",
        "action": "focus first tab"
      },
      "End": {
        "target": ".wb-tabs__tab",
        "action": "focus last tab"
      },
      "Enter": {
        "target": ".wb-tabs__tab",
        "action": "activate focused tab"
      },
      "Space": {
        "target": ".wb-tabs__tab",
        "action": "activate focused tab"
      }
    }
  },

  "accessibility": {
    "tablist": {
      "role": "tablist"
    },
    "tab": {
      "role": "tab",
      "aria-selected": "dynamic",
      "aria-controls": "panel ID",
      "tabindex": "0 for active, -1 for inactive"
    },
    "panel": {
      "role": "tabpanel",
      "aria-labelledby": "tab ID"
    }
  },

  "events": {
    "wb:tabs:change": {
      "trigger": "Active tab changes",
      "detail": {
        "index": "number",
        "previousIndex": "number"
      },
      "bubbles": true
    }
  },

  "test": {
    "setup": [
      "<div data-wb=\"tabs\"><div data-tab-title=\"Tab 1\">Content 1</div><div data-tab-title=\"Tab 2\">Content 2</div></div>",
      "<div data-wb=\"tabs\"><div data-tab-title=\"First\">First content</div><div data-tab-title=\"Second\">Second content</div><div data-tab-title=\"Third\">Third content</div></div>"
    ],
    "matrix": {
      "combinations": [
        {},
        { "activeTab": 0 },
        { "activeTab": 1 }
      ]
    },
    "functional": {
      "buttons": [
        {
          "name": "clicking tab activates it",
          "setup": "<div data-wb=\"tabs\"><div data-tab-title=\"Tab 1\">Content 1</div><div data-tab-title=\"Tab 2\">Content 2</div></div>",
          "selector": ".wb-tabs__tab:nth-child(2)",
          "expect": {
            "selector": ".wb-tabs__tab:nth-child(2)",
            "hasClass": "wb-tabs__tab--active"
          }
        }
      ],
      "interactions": [
        {
          "name": "clicking tab shows corresponding panel",
          "setup": "<div data-wb=\"tabs\"><div data-tab-title=\"Tab 1\">Content 1</div><div data-tab-title=\"Tab 2\">Content 2</div></div>",
          "action": "click",
          "selector": ".wb-tabs__tab:nth-child(2)",
          "expect": {
            "selector": ".wb-tabs__panel:nth-child(2)",
            "visible": true
          }
        },
        {
          "name": "clicking tab fires change event",
          "setup": "<div data-wb=\"tabs\"><div data-tab-title=\"Tab 1\">Content 1</div><div data-tab-title=\"Tab 2\">Content 2</div></div>",
          "action": "click",
          "selector": ".wb-tabs__tab:nth-child(2)",
          "expect": {
            "event": "wb:tabs:change"
          }
        }
      ],
      "keyboard": [
        {
          "name": "ArrowRight moves focus to next tab",
          "setup": "<div data-wb=\"tabs\"><div data-tab-title=\"Tab 1\">Content 1</div><div data-tab-title=\"Tab 2\">Content 2</div></div>",
          "precondition": { "focused": ".wb-tabs__tab:first-child" },
          "key": "ArrowRight",
          "expect": {
            "focused": ".wb-tabs__tab:nth-child(2)"
          }
        },
        {
          "name": "ArrowLeft moves focus to previous tab",
          "setup": "<div data-wb=\"tabs\"><div data-tab-title=\"Tab 1\">Content 1</div><div data-tab-title=\"Tab 2\">Content 2</div></div>",
          "precondition": { "focused": ".wb-tabs__tab:nth-child(2)" },
          "key": "ArrowLeft",
          "expect": {
            "focused": ".wb-tabs__tab:first-child"
          }
        },
        {
          "name": "Home moves focus to first tab",
          "setup": "<div data-wb=\"tabs\"><div data-tab-title=\"Tab 1\">Content 1</div><div data-tab-title=\"Tab 2\">Content 2</div><div data-tab-title=\"Tab 3\">Content 3</div></div>",
          "precondition": { "focused": ".wb-tabs__tab:nth-child(3)" },
          "key": "Home",
          "expect": {
            "focused": ".wb-tabs__tab:first-child"
          }
        },
        {
          "name": "End moves focus to last tab",
          "setup": "<div data-wb=\"tabs\"><div data-tab-title=\"Tab 1\">Content 1</div><div data-tab-title=\"Tab 2\">Content 2</div><div data-tab-title=\"Tab 3\">Content 3</div></div>",
          "precondition": { "focused": ".wb-tabs__tab:first-child" },
          "key": "End",
          "expect": {
            "focused": ".wb-tabs__tab:last-child"
          }
        },
        {
          "name": "Enter activates focused tab",
          "setup": "<div data-wb=\"tabs\"><div data-tab-title=\"Tab 1\">Content 1</div><div data-tab-title=\"Tab 2\">Content 2</div></div>",
          "precondition": { "focused": ".wb-tabs__tab:nth-child(2)" },
          "key": "Enter",
          "expect": {
            "selector": ".wb-tabs__tab:nth-child(2)",
            "hasClass": "wb-tabs__tab--active"
          }
        }
      ],
      "visual": [
        {
          "name": "tabs container has base class",
          "setup": "<div data-wb=\"tabs\"><div data-tab-title=\"Tab 1\">Content 1</div></div>",
          "expect": {
            "selector": "element",
            "hasClass": "wb-tabs"
          }
        },
        {
          "name": "active tab has active class",
          "setup": "<div data-wb=\"tabs\"><div data-tab-title=\"Tab 1\">Content 1</div><div data-tab-title=\"Tab 2\">Content 2</div></div>",
          "expect": {
            "selector": ".wb-tabs__tab:first-child",
            "hasClass": "wb-tabs__tab--active"
          }
        },
        {
          "name": "inactive panels are hidden",
          "setup": "<div data-wb=\"tabs\"><div data-tab-title=\"Tab 1\">Content 1</div><div data-tab-title=\"Tab 2\">Content 2</div></div>",
          "expect": {
            "selector": ".wb-tabs__panel:nth-child(2)",
            "visible": false
          }
        }
      ]
    }
  }
}
