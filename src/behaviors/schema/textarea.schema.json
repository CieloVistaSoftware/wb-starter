{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Textarea",
  "description": "Enhanced textarea with autosize, character count, and max length features",
  "behavior": "textarea",
  "element": "textarea",
  
  "properties": {
    "autosize": {
      "type": "boolean",
      "description": "Whether textarea auto-resizes to content",
      "default": false,
      "permutations": {
        "type": "BOOLEAN",
        "assertions": {
          "true": { "selector": "element", "checks": { "hasClass": "wb-textarea--autosize" } }
        }
      }
    },
    "maxLength": {
      "type": "number",
      "description": "Maximum character limit",
      "default": 0,
      "minimum": 0,
      "maximum": 10000,
      "permutations": {
        "type": "EXPLICIT",
        "values": [0, 100, 500, 1000],
        "assertions": {
          "100": { "selector": "element", "checks": { "attribute": { "maxlength": "100" } } },
          "500": { "selector": "element", "checks": { "attribute": { "maxlength": "500" } } }
        }
      }
    },
    "showCount": {
      "type": "boolean",
      "description": "Whether to show character count",
      "default": false,
      "permutations": {
        "type": "BOOLEAN",
        "assertions": {
          "true": { "selector": ".wb-textarea__counter", "checks": { "exists": true } }
        }
      }
    },
    "disabled": {
      "type": "boolean",
      "description": "Whether the textarea is disabled",
      "default": false,
      "permutations": {
        "type": "BOOLEAN",
        "assertions": {
          "true": { "selector": "element", "checks": { "attribute": { "disabled": "" } } }
        }
      }
    },
    "readonly": {
      "type": "boolean",
      "description": "Whether the textarea is read-only",
      "default": false,
      "permutations": {
        "type": "BOOLEAN",
        "assertions": {
          "true": { "selector": "element", "checks": { "attribute": { "readonly": "" } } }
        }
      }
    },
    "placeholder": {
      "type": "string",
      "description": "Placeholder text",
      "default": "",
      "permutations": {
        "type": "EXPLICIT",
        "values": [null, "Enter text...", "Type your message here"]
      }
    },
    "rows": {
      "type": "number",
      "description": "Number of visible text rows",
      "default": 3,
      "minimum": 1,
      "maximum": 20,
      "permutations": {
        "type": "EXPLICIT",
        "values": [3, 5, 10],
        "assertions": {
          "5": { "selector": "element", "checks": { "attribute": { "rows": "5" } } },
          "10": { "selector": "element", "checks": { "attribute": { "rows": "10" } } }
        }
      }
    }
  },
  
  "compliance": {
    "baseClass": "wb-textarea",
    "requiredChildren": {},
    "optionalChildren": {
      ".wb-textarea__counter": {
        "description": "Character counter element",
        "createdWhen": "data-show-count is set"
      }
    },
    "styles": {
      "padding": {
        "required": true
      },
      "borderRadius": {
        "required": true
      },
      "border": {
        "required": true
      },
      "resize": {
        "required": false,
        "value": "vertical"
      }
    }
  },
  
  "interactions": {
    "elements": {
      "element": {
        "type": "textarea",
        "clickable": true,
        "click": {
          "action": "focus textarea field",
          "event": "focus"
        },
        "focus": {
          "style": { "outline": "2px solid var(--primary)" },
          "visible": true
        }
      }
    },
    "keyboard": {
      "Tab": {
        "target": "element",
        "action": "focus"
      }
    }
  },
  
  "accessibility": {
    "element": {
      "description": "Textarea should be focusable and announce its purpose"
    }
  },
  
  "events": {
    "input": {
      "trigger": "User types in the textarea",
      "detail": {},
      "bubbles": true
    },
    "focus": {
      "trigger": "Textarea receives focus",
      "detail": {},
      "bubbles": true
    },
    "blur": {
      "trigger": "Textarea loses focus",
      "detail": {},
      "bubbles": true
    }
  },
  
  "test": {
    "setup": [
      "<textarea data-wb=\"textarea\" placeholder=\"Enter text...\"></textarea>",
      "<textarea data-wb=\"textarea\" data-autosize></textarea>",
      "<textarea data-wb=\"textarea\" data-max-length=\"500\" data-show-count></textarea>",
      "<textarea data-wb=\"textarea\" rows=\"5\"></textarea>",
      "<textarea data-wb=\"textarea\" disabled></textarea>"
    ],
    
    "matrix": {
      "combinations": [
        {},
        { "autosize": true },
        { "maxLength": 100 },
        { "showCount": true },
        { "maxLength": 500, "showCount": true },
        { "rows": 5 },
        { "rows": 10 },
        { "disabled": true },
        { "readonly": true },
        { "autosize": true, "maxLength": 200, "showCount": true }
      ]
    },
    
    "functional": {
      "buttons": [],
      
      "interactions": [
        {
          "name": "textarea is focusable",
          "setup": "<textarea data-wb=\"textarea\" placeholder=\"Test\"></textarea>",
          "action": "click",
          "expect": {}
        },
        {
          "name": "textarea accepts input",
          "setup": "<textarea data-wb=\"textarea\"></textarea>",
          "action": "type",
          "value": "Hello World",
          "expect": {
            "value": "Hello World"
          }
        }
      ],
      
      "keyboard": [
        {
          "name": "Tab focuses textarea",
          "setup": "<textarea data-wb=\"textarea\"></textarea>",
          "key": "Tab",
          "expect": {}
        }
      ],
      
      "visual": [
        {
          "name": "textarea has base styling",
          "setup": "<textarea data-wb=\"textarea\"></textarea>",
          "expect": {
            "selector": "element",
            "hasClass": ["wb-textarea"]
          }
        },
        {
          "name": "showCount creates counter element",
          "setup": "<textarea data-wb=\"textarea\" data-show-count></textarea>",
          "expect": {
            "selector": ".wb-textarea__counter",
            "exists": true
          }
        },
        {
          "name": "counter shows current/max format",
          "setup": "<textarea data-wb=\"textarea\" data-max-length=\"100\" data-show-count></textarea>",
          "expect": {
            "selector": ".wb-textarea__counter",
            "textContains": "/100"
          }
        },
        {
          "name": "disabled textarea has disabled attribute",
          "setup": "<textarea data-wb=\"textarea\" disabled></textarea>",
          "expect": {
            "selector": "element",
            "attribute": { "disabled": "" }
          }
        }
      ]
    }
  }
}
